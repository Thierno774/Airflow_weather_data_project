[2024-12-23T12:04:32.797+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_dag.prepare_data manual__2024-12-23T12:04:23.519794+00:00 [queued]>
[2024-12-23T12:04:32.804+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_dag.prepare_data manual__2024-12-23T12:04:23.519794+00:00 [queued]>
[2024-12-23T12:04:32.804+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 3
[2024-12-23T12:04:32.816+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): prepare_data> on 2024-12-23 12:04:23.519794+00:00
[2024-12-23T12:04:32.822+0000] {standard_task_runner.py:60} INFO - Started process 10527 to run task
[2024-12-23T12:04:32.824+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'weather_dag', 'prepare_data', 'manual__2024-12-23T12:04:23.519794+00:00', '--job-id', '218', '--raw', '--subdir', 'DAGS_FOLDER/extract.py', '--cfg-path', '/tmp/tmpn41kpx63']
[2024-12-23T12:04:32.824+0000] {standard_task_runner.py:88} INFO - Job 218: Subtask prepare_data
[2024-12-23T12:04:32.835+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:194: DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
  SQL_ALCHEMY_CONN = conf.get("database", "SQL_ALCHEMY_CONN")

[2024-12-23T12:04:32.863+0000] {task_command.py:423} INFO - Running <TaskInstance: weather_dag.prepare_data manual__2024-12-23T12:04:23.519794+00:00 [running]> on host b853fb0270cd
[2024-12-23T12:04:32.914+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='thiernosidybah232@gmail.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_dag' AIRFLOW_CTX_TASK_ID='prepare_data' AIRFLOW_CTX_EXECUTION_DATE='2024-12-23T12:04:23.519794+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-12-23T12:04:23.519794+00:00'
[2024-12-23T12:04:32.926+0000] {logging_mixin.py:188} INFO -      temperature                        city  pression                 date
173       279.58  Arrondissement de Grenoble      1024  2024-12-18 13:14:37
164       268.46  Arrondissement de Grenoble      1017  2024-12-23 08:35:38
155       268.46  Arrondissement de Grenoble      1017  2024-12-23 08:39:05
146       268.46  Arrondissement de Grenoble      1017  2024-12-23 08:46:05
137       268.46  Arrondissement de Grenoble      1017  2024-12-23 08:50:22
[2024-12-23T12:04:32.927+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.928+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.929+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.930+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.931+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.932+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.935+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.935+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.937+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.938+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.939+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.940+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.943+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.943+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.945+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.946+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.947+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.948+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.951+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.951+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.952+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.953+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.954+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.955+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.958+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.958+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.960+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.961+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.961+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.962+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.965+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.965+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.967+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.968+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.968+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.969+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.972+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.972+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.974+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.975+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.976+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.976+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.979+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.979+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.981+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.982+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.983+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.984+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.986+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:118: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, "target"] = data_temp['temperature'].shift(1)

[2024-12-23T12:04:32.987+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.988+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.989+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.990+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:32.991+0000] {warnings.py:109} WARNING - /opt/***/dags/extract.py:121: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_temp.loc[:, f"temp_m-{element}"] = data_temp['temperature'].shift(-element)

[2024-12-23T12:04:33.132+0000] {python.py:201} INFO - Done. Returned value was: (     temperature  pression  ...  city_New York  city_Toulouse
164       268.46      1017  ...          False          False
155       268.46      1017  ...          False          False
146       268.46      1017  ...          False          False
137       268.46      1017  ...          False          False
128       268.46      1017  ...          False          False
..           ...       ...  ...            ...            ...
90        279.14      1029  ...          False           True
162       279.14      1028  ...          False           True
153       279.14      1029  ...          False           True
144       279.14      1029  ...          False           True
135       279.14      1029  ...          False           True

[540 rows x 20 columns], 164    279.58
155    268.46
146    268.46
137    268.46
128    268.46
        ...  
90     279.14
162    288.14
153    279.14
144    279.14
135    279.14
Name: target, Length: 540, dtype: float64)
[2024-12-23T12:04:33.162+0000] {xcom.py:664} ERROR - Object of type tuple is not JSON serializable. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your *** config or make sure to decorate your object with attr.
[2024-12-23T12:04:33.163+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/json.py", line 91, in default
    return serialize(o)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/serialization/serde.py", line 147, in serialize
    return encode(classname, version, serialize(data, depth + 1))
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/serialization/serde.py", line 126, in serialize
    return [serialize(d, depth + 1) for d in o]
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/serialization/serde.py", line 126, in <listcomp>
    return [serialize(d, depth + 1) for d in o]
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/serialization/serde.py", line 180, in serialize
    raise TypeError(f"cannot serialize object of type {cls}")
TypeError: cannot serialize object of type <class 'pandas.core.series.Series'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 440, in _execute_task
    task_instance.xcom_push(key=XCOM_RETURN_KEY, value=xcom_value, session=session)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 2980, in xcom_push
    XCom.set(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/xcom.py", line 247, in set
    value = cls.serialize_value(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/xcom.py", line 662, in serialize_value
    return json.dumps(value, cls=XComEncoder).encode("UTF-8")
  File "/usr/local/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/json.py", line 102, in encode
    o = self.default(o)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/json.py", line 93, in default
    return super().default(o)
  File "/usr/local/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type tuple is not JSON serializable
[2024-12-23T12:04:33.172+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=weather_dag, task_id=prepare_data, execution_date=20241223T120423, start_date=20241223T120432, end_date=20241223T120433
[2024-12-23T12:04:33.185+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 218 for task prepare_data (Object of type tuple is not JSON serializable; 10527)
[2024-12-23T12:04:33.236+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-12-23T12:04:33.249+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
